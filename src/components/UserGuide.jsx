import { useState, useImperativeHandle, forwardRef } from 'react';
import { Button } from '@/components/ui/button';
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogDescription } from '@/components/ui/dialog';
import { ScrollArea } from '@/components/ui/scroll-area';


const UserGuide = forwardRef((props, ref) => {
  const [open, setOpen] = useState(false);

  useImperativeHandle(ref, () => ({
    open: () => setOpen(true),
    close: () => setOpen(false)
  }));
   if (!open) {
    return null;
  }

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogContent className="sm:max-w-3xl">
        <DialogHeader>
          <DialogTitle>Руководство пользователя - СПУ</DialogTitle>
          <DialogDescription>
    Краткое руководство по основным функциям приложения.
  </DialogDescription>
          
        </DialogHeader>
        <ScrollArea className="h-[70vh] pr-4">
          <div className="user-guide-content">
            <h2>Добро пожаловать в систему сетевого планирования и управления!</h2>
            
            <p>
              Данное приложение предназначено для создания и анализа сетевых графиков проектов, 
              расчета критического пути и управления ресурсами.
            </p>

            <h2>Основные функции</h2>

            <h3>1. Ввод работ</h3>
            <p>
              В этой вкладке вы можете добавлять работы проекта. Слева отображается список уже добавленных работ, 
              справа - форма для добавления новых работ.
            </p>
            <ul>
              <li><strong>ID работы</strong> - уникальный идентификатор (например, 1-2)</li>
              <li><strong>Название</strong> - описание работы с автодополнением из базы данных</li>
              <li><strong>Продолжительность</strong> - время выполнения в днях</li>
              <li><strong>Трудоемкость</strong> - объем работы в человеко-часах</li>
              <li><strong>Количество исполнителей</strong> - число людей, выполняющих работу</li>
              <li><strong>Предшественники</strong> - работы, которые должны быть завершены перед началом данной</li>
            </ul>

            <h3>2. Сетевой график</h3>
            <p>
              Визуальное представление проекта в виде сетевого графика. Показывает связи между работами 
              и критический путь.
            </p>
            <ul>
              <li>Используйте <code>Ctrl + колесо мыши</code> для масштабирования</li>
            </ul>

            <h3>3. Результаты</h3>
            <p>
              Отображает результаты расчетов: критический путь, общую продолжительность проекта, 
              резервы времени для каждой работы.
            </p>

            <h3>4. Диаграмма Ганта</h3>
            <p>
              Временная диаграмма проекта, показывающая последовательность и продолжительность работ 
              на временной шкале.
            </p>
               <ul>
              <li>Используйте <code>Ctrl + колесо мыши</code> для масштабирования</li>
            </ul>
            

            <h3>5. Календарь</h3>
            <p>
              Управление календарем проекта, настройка рабочих дней, праздников и вех проекта.
            </p>
            <ul>
              <li><strong>Календарь</strong> - основной календарь с цветовой индикацией</li>
              <li><strong>Праздники</strong> - настройка нерабочих дней</li>
              <li><strong>Вехи</strong> - важные события проекта</li>
            </ul>

            <h3>6. Анализ</h3>
            <p>Инструменты для анализа проекта:</p>
            <ul>
              <li><strong>Ресурсы</strong> - управление ресурсами проекта</li>
              <li><strong>Временная шкала</strong> - анализ временных характеристик</li>
              <li><strong>Что-если</strong> - моделирование различных сценариев</li>
            </ul>

            <h3>7. Инструменты</h3>
            <p>Дополнительные инструменты:</p>
            <ul>
              <li><strong>Импорт/Экспорт</strong> - загрузка и сохранение проектов</li>
              <li><strong>Логи</strong> - просмотр журнала действий</li>
              <li><strong>Настройки темы</strong> - выбор цветовой схемы</li>
            </ul>

            <h2>Управление проектом</h2>

            <h3>Сохранение и загрузка</h3>
            <p>
              Используйте кнопки в верхней панели для управления проектом:
            </p>
            <ul>
              <li><strong>Рассчитать параметры</strong> - выполнить расчет сетевого графика</li>
              <li><strong>Загрузить пример</strong> - загрузить демонстрационные данные</li>
              <li><strong>Очистить все</strong> - удалить все работы из проекта</li>
            </ul>

            <h3>Горячие клавиши</h3>
            <ul>
              <li><code>Ctrl +</code> - увеличить масштаб приложения</li>
              <li><code>Ctrl -</code> - уменьшить масштаб приложения</li>
              <li><code>Ctrl + колесо мыши</code> - масштабирование сетевого графика и диаграммы Ганта</li>
            </ul>

            <h2>Советы по использованию</h2>

            <ul>
              <li>Начните с добавления работ во вкладке "Ввод работ"</li>
              <li>Используйте автодополнение для быстрого ввода типовых работ</li>
              <li>Обязательно указывайте предшественников для корректного построения сетевого графика</li>
              <li>После добавления всех работ нажмите "Рассчитать параметры"</li>
              <li>Проверьте результаты во вкладке "Результаты"</li>
              <li>Используйте диаграмму Ганта для планирования ресурсов</li>
              <li>Регулярно сохраняйте проект для предотвращения потери данных</li>
            </ul>

            <h2>Устранение неполадок</h2>

            <p>
              Если возникают проблемы:
            </p>
            <ul>
              <li>Проверьте корректность ID работ и предшественников</li>
              <li>Убедитесь, что все обязательные поля заполнены</li>
              <li>Используйте вкладку "Логи" для диагностики ошибок</li>
              <li>При необходимости очистите проект и начните заново</li>
            </ul>
          </div>
        </ScrollArea>
        <DialogFooter>
          <Button onClick={() => setOpen(false)}>Закрыть</Button>
        </DialogFooter>
      </DialogContent>
    </Dialog>
  );
});

export default UserGuide;
